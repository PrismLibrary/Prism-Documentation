"use strict";(globalThis.webpackChunkprism_docs=globalThis.webpackChunkprism_docs||[]).push([[5325],{8453:(e,i,n)=>{n.d(i,{R:()=>o,x:()=>a});var r=n(6540);const s={},t=r.createContext(s);function o(e){const i=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(t.Provider,{value:i},e.children)}},9092:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>o,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"platforms/maui/appbuilder","title":"App Builder","description":".NET MAUI adopts a pattern that we see commonly throughout modern .NET Applications with a Builder Pattern. Prism.Maui adopts this as part of the natural pattern for MAUI Developers by first exposing an extension method on the MauiAppBuilder. To get started we simply need to include UsePrism after the UseMauiApp call on the MauiAppBuilder.","source":"@site/versioned_docs/version-9.0/platforms/maui/appbuilder.md","sourceDirName":"platforms/maui","slug":"/platforms/maui/appbuilder","permalink":"/docs/9.0/platforms/maui/appbuilder","draft":false,"unlisted":false,"editUrl":"https://github.com/PrismLibrary/Prism-Documentation/edit/master/versioned_docs/version-9.0/platforms/maui/appbuilder.md","tags":[],"version":"9.0","lastUpdatedBy":"Dan Siegel","lastUpdatedAt":1763924367000,"sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"PrismNavigationPage","permalink":"/docs/9.0/platforms/maui/navigation/prismnavigationpage"},"next":{"title":"Getting Started with Behaviors","permalink":"/docs/9.0/platforms/maui/behaviors/"}}');var s=n(4848),t=n(8453);const o={sidebar_position:3},a="App Builder",l={},d=[{value:"Configuring Prism",id:"configuring-prism",level:2},{value:"Registering Services with Prism&#39;s IContainerRegistry",id:"registering-services-with-prisms-icontainerregistry",level:3},{value:"Platform Specific Registrations",id:"platform-specific-registrations",level:4},{value:"IServiceCollection Support",id:"iservicecollection-support",level:3},{value:"Logging Support",id:"logging-support",level:3},{value:"OnInitialized",id:"oninitialized",level:3},{value:"Configuring the Module Catalog",id:"configuring-the-module-catalog",level:3},{value:"CreateWindow",id:"createwindow",level:3}];function c(e){const i={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.header,{children:(0,s.jsx)(i.h1,{id:"app-builder",children:"App Builder"})}),"\n",(0,s.jsxs)(i.p,{children:[".NET MAUI adopts a pattern that we see commonly throughout modern .NET Applications with a Builder Pattern. Prism.Maui adopts this as part of the natural pattern for MAUI Developers by first exposing an extension method on the ",(0,s.jsx)(i.code,{children:"MauiAppBuilder"}),". To get started we simply need to include ",(0,s.jsx)(i.code,{children:"UsePrism"})," after the ",(0,s.jsx)(i.code,{children:"UseMauiApp"})," call on the ",(0,s.jsx)(i.code,{children:"MauiAppBuilder"}),"."]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-cs",children:"var builder = MauiApp.CreateBuilder();\n\n// Default MAUI Applications\nbuilder.UseMauiApp<App>();\n\n// Include UsePrism after UseMauiApp\nbuilder.UseMauiApp<App>();\nbuilder.UsePrism(prism =>\n{\n    // configure prism\n});\n"})}),"\n",(0,s.jsx)(i.h2,{id:"configuring-prism",children:"Configuring Prism"}),"\n",(0,s.jsxs)(i.p,{children:["The ",(0,s.jsx)(i.code,{children:"UsePrism"})," method expects a delegate that will configure the startup for Prism applications. This includes registering services, adding modules, and various other common tasks. While we have tried to keep this as simple as possible, we have also tried to provide a number of overloads to make it easier to get started for developers who may have different requirements as you will see as we go into depth into the ",(0,s.jsx)(i.code,{children:"PrismAppBuilder"}),"."]}),"\n",(0,s.jsx)(i.admonition,{type:"note",children:(0,s.jsxs)(i.p,{children:["In the Prism Templates we use a static ",(0,s.jsx)(i.code,{children:"PrismStartup"})," class. The class is no way required. This is provided out of the box for convenience as many medium to large apps may have hundreds of lines of code simply to register base services. We find that smaller/focused files are easier for many developers to maintain. By moving the configuration of Prism to another file we can more easily focus on thew lines that build the pipeline for the MauiApplicationBuilder."]})}),"\n",(0,s.jsx)(i.h3,{id:"registering-services-with-prisms-icontainerregistry",children:"Registering Services with Prism's IContainerRegistry"}),"\n",(0,s.jsxs)(i.p,{children:["If you are coming to Prism.Maui from Prism.Forms, Prism.Wpf, or Prism.Uno you may be familiar with the RegisterTypes on the PrismApplication. In Prism.Maui this has moved to the ",(0,s.jsx)(i.code,{children:"PrismAppBuilder"}),"."]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-cs",children:"var builder = MauiApp.CreateBuilder();\nbuilder.UseMauiApp<App>();\nbuilder.UsePrism(prism =>\n{\n    prism.RegisterTypes(container => {\n        // Register platform agnostic types\n    });\n});\n"})}),"\n",(0,s.jsx)(i.admonition,{type:"note",children:(0,s.jsxs)(i.p,{children:["In the case where you only see the variant of ",(0,s.jsx)(i.code,{children:"UsePrism"})," which requires an instance of the ",(0,s.jsx)(i.code,{children:"IContainerProvider"})," this means that you are missing ",(0,s.jsx)(i.code,{children:"Prism.DryIoc.Maui"}),". For most cases you will want this installed. Commercial Plus users may optionally install a different container package from the Prism NuGet feed such as Microsoft Extensions DependencyInjection or Grace Ioc. In these cases you would not need the ",(0,s.jsx)(i.code,{children:"Prism.DryIoc.Maui"})," package as you have another container to provide. All other users should use make sure ",(0,s.jsx)(i.code,{children:"Prism.DryIoc.Maui"})," is installed."]})}),"\n",(0,s.jsx)(i.h4,{id:"platform-specific-registrations",children:"Platform Specific Registrations"}),"\n",(0,s.jsx)(i.p,{children:"MAUI Single Project eliminates the need for the goofy IPlatformInitializer that was required for Prism.Forms. Registering Platform Specific services is as simple as including a compiler directive in your project."}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-cs",children:"prism.RegisterTypes(container =>\n{\n#if IOS\n    container.Register<IFoo, iOSFoo>();\n#elif ANDROID\n    container.Register<IFoo, AndroidFoo>();\n#elif WINDOWS\n    container.Register<IFoo, WindowsFoo>();\n#elif MACCATALYST\n    container.Register<IFoo, MacCatalystFoo>();\n#elif TIZEN\n    container.Register<IFoo, TizenFoo>();\n#endif\n});\n"})}),"\n",(0,s.jsxs)(i.p,{children:["For larger projects where you may have a larger number of platform specific registrations you may instead want to simply write an extension method in your platform specific code. In this case let's say that the project name is ",(0,s.jsx)(i.code,{children:"MyAwesomeProject"})," and you want to register your services with an extension method. You would start by creating a static class in each platform specific folder which has the namespace ",(0,s.jsx)(i.code,{children:"MyAwesomeProject"})," so that you can reference without any compiler directives for namespace usings."]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-cs",children:"public static class PlatformRegistrations\n{\n    public static void RegisterPlatformTypes(IContainerRegistry container)\n    {\n        container.Register<IFoo, iOSFoo>();\n    }\n}\n"})}),"\n",(0,s.jsx)(i.p,{children:"With this we can now simply update our our code like:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-cs",children:"var builder = MauiApp.CreateBuilder();\nbuilder.UseMauiApp<App>()\nbuilder.UsePrism(prism =>\n{\n    prism.RegisterTypes(PlatformRegistrations.RegisterPlatformTypes)\n        .RegisterTypes(container => {\n            // Register platform agnostic types\n        });\n});\n"})}),"\n",(0,s.jsx)(i.h3,{id:"iservicecollection-support",children:"IServiceCollection Support"}),"\n",(0,s.jsxs)(i.p,{children:["While the ",(0,s.jsx)(i.code,{children:"MauiAppBuilder"})," does expose the ",(0,s.jsx)(i.code,{children:"IServicesCollection"})," through the ",(0,s.jsx)(i.code,{children:"Services"})," property, it does not have an easy to use extension for registering services. To help make it even easier on developers using Prism, we have exposed an extension method on the ",(0,s.jsx)(i.code,{children:"PrismAppBuilder"})," to give you the ability to easily register services with either ",(0,s.jsx)(i.code,{children:"IContainerRegistry"})," or ",(0,s.jsx)(i.code,{children:"IServiceCollection"})," on an as needed basis. As discussed in the ",(0,s.jsx)(i.a,{href:"../../dependency-injection/servicecollection-supplement",children:"Dependency Injection - Supplement"})," topic, we do expose several additional extensions on the ",(0,s.jsx)(i.code,{children:"IServiceCollection"})," to make it even easier on you to ensure you can register what you need to with Prism even when you're using the ",(0,s.jsx)(i.code,{children:"IServiceCollection"}),"."]}),"\n",(0,s.jsx)(i.admonition,{type:"note",children:(0,s.jsxs)(i.p,{children:["It's important to remember that if you register a service with the ",(0,s.jsx)(i.code,{children:"IServiceCollection"})," it will not be available from the ",(0,s.jsx)(i.code,{children:"IContainerRegistry"}),". As a result if you call the ",(0,s.jsx)(i.code,{children:"IsRegistered<T>"})," method on the ",(0,s.jsx)(i.code,{children:"IContainerRegistry"})," it will return ",(0,s.jsx)(i.code,{children:"false"}),"."]})}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-cs",children:"var builder = MauiApp.CreateBuilder();\nbuilder.UseMauiApp<App>()\nbuilder.UsePrism(prism => {\n    prism.ConfigureServices(services => {\n        // Register services with the IServiceCollection\n        services.AddSingleton<IFoo, Foo>();\n    });\n});\n"})}),"\n",(0,s.jsx)(i.h3,{id:"logging-support",children:"Logging Support"}),"\n",(0,s.jsxs)(i.p,{children:["Similar to the ",(0,s.jsx)(i.code,{children:"ConfigureServices"})," overload which is provided as a convenience method, the ",(0,s.jsx)(i.code,{children:"ConfigureLogging"})," method is also provided as a convenience method. This method allows you to easily configure the logging for your application using the Microsoft ",(0,s.jsx)(i.code,{children:"ILoggingBuilder"}),". It is important to note that this is provided through the ",(0,s.jsx)(i.code,{children:"MauiAppBuilder"}),", and Prism does not make use of the ",(0,s.jsx)(i.code,{children:"ILogger"})," anywhere internally."]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-cs",children:"var builder = MauiApp.CreateBuilder();\nbuilder.UseMauiApp<App>()\nbuilder.UsePrism(prism => {\n    prism.ConfigureLogging(builder => {\n        builder.AddConsole();\n    });\n});\n"})}),"\n",(0,s.jsx)(i.h3,{id:"oninitialized",children:"OnInitialized"}),"\n",(0,s.jsxs)(i.p,{children:["While .NET MAUI does actually provide an interface that you can register to handle registration logic, something that 3rd parties like Prism or ShinyLib both utilize, it may be overkill for you. Prism provides 2 easy to use overloads for the ",(0,s.jsx)(i.code,{children:"OnInitialized"})," method. You can use either of these methods to do any initializations."]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-cs",children:"var builder = MauiApp.CreateBuilder();\nbuilder.UseMauiApp<App>()\nbuilder.UsePrism(prism =>\n{\n    prism.OnInitialized(container =>\n    {\n        // resolve services and do other initialization\n    })\n    .OnInitialized(() => {\n        // do some initialization that doesn't require resolving services\n    });\n}\n"})}),"\n",(0,s.jsx)(i.h3,{id:"configuring-the-module-catalog",children:"Configuring the Module Catalog"}),"\n",(0,s.jsxs)(i.p,{children:["For those coming from other platforms you may be used to adding your Modules to the ModuleCatalog in the ",(0,s.jsx)(i.code,{children:"PrismApplication"}),". The ",(0,s.jsx)(i.code,{children:"PrismAppBuilder"})," also provides an easy to use method for adding modules to the ModuleCatalog."]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-cs",children:"var builder = MauiApp.CreateBuilder();\nbuilder.UseMauiApp<App>()\nbuilder.UsePrism(prism => {\n    prism.ConfigureModuleCatalog(moduleCatalog => {\n        moduleCatalog.AddModule<ModuleA>();\n        moduleCatalog.AddModule<ModuleB>();\n    });\n});\n"})}),"\n",(0,s.jsx)(i.h3,{id:"createwindow",children:"CreateWindow"}),"\n",(0,s.jsx)(i.admonition,{type:"note",children:(0,s.jsx)(i.p,{children:"If upgrading from previews of Prism.Maui CreateWindow has replaced the formerly available OnAppStart"})}),"\n",(0,s.jsxs)(i.p,{children:["In .NET MAUI, the Application has been re-architected. While the ",(0,s.jsx)(i.code,{children:"Application.MainPage"})," still technically exists for legacy compatibility purposes it is not used. .NET MAUI instead uses an API that focuses around the use of Windows. While the exact implementation of what a Window is may vary based on Desktop vs Mobile, the concept nonetheless is central to the design and application startup process."]}),"\n",(0,s.jsxs)(i.p,{children:["Prism registers a service with .NET MAUI that allows Prism to provide a callback and return the initial application window that will be created for the Application in the ",(0,s.jsx)(i.code,{children:"Application.CreateWindow"})," method. While the Window is abstracted away from Prism's Uri based navigation, this extension of the ",(0,s.jsx)(i.code,{children:"PrismAppBuilder"})," has been mapped to match the name of the corresponding .NET MAUI API that ultimately invokes it to better show where your code will be executed."]}),"\n",(0,s.jsxs)(i.p,{children:["The CreateWindow method is one of the most important methods on the ",(0,s.jsx)(i.code,{children:"PrismAppBuilder"})," as it is used as your starting point to set the initial Navigation Event for Prism. We provide a number of overloads here to make it easier for you whether you want to operate within an Async or Synchronous context. We also provide overloads that let you access the container to resolve services you may need such as the ",(0,s.jsx)(i.code,{children:"ILogger"})," to Log a Navigation Exception that was encountered. Additionally if you want to keep things as simple as possible we even have an overload to let you only pass in a Navigation URI."]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-cs",children:'var builder = MauiApp.CreateBuilder();\nbuilder.UseMauiApp<App>()\n\n// Bare Bones\nbuilder.UsePrism(prism => {\n    // Register Types excluded for brevity\n    prism.CreateWindow("/MainPage");\n});\n\n// Bare Bones with Exception Handler\nbuilder.UsePrism(prism => {\n    // Register Types excluded for brevity\n    prism.CreateWindow("/MainPage", exception => Console.WriteLine(exception));\n});\n\n// Use the NavigationService\nbuilder.UsePrism(prism => {\n    // Register Types excluded for brevity\n    prism.CreateWindow(navigation => navigation.NavigateAsync("/MainPage"));\n});\n\n// Use the NavigationBuilder\nbuilder.UsePrism(prism => {\n    // Register Types excluded for brevity\n    prism.CreateWindow(navigation => navigation.CreateBuilder()\n        .UseAbsoluteNavigation()\n        .AddSegment("MainPage"))\n});\n\n// Use the NavigationService & Container\nbuilder.UsePrism(prism => {\n    // Register Types excluded for brevity\n    prism.CreateWindow(async (container, navigation) => {\n        var result =  await navigation.NavigateAsync("/MainPage");\n        if(!result.Success)\n        {\n            var logger = container.Resolve<ILogger<MauiProgram>>();\n            logger.Log(result.Exception);\n        }\n    });\n});\n'})})]})}function p(e={}){const{wrapper:i}={...(0,t.R)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}}}]);